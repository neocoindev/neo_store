{% extends 'partials/base.html' %} 
{% load static %} 
{% load humanize %} 
{% load currency_tags %}

{% block content %}

<!-- Подключение стилей для улучшенного каталога -->
<link href="{% static 'assets/css/shop.css' %}" rel="stylesheet" />

<section class="middle">
    <div class="container">
        <!-- Заголовок с количеством товаров -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="fw-bold mb-0">Все товары (<span class="product_count">{{ products_list.count }}</span>)</h2>
        </div>
        
        <!-- Секция поиска и фильтров -->
        <div class="wb-filters-section mb-4">
            <div class="mb-3 d-flex justify-content-between align-items-center gap-2">
                <input 
                    type="text" 
                    class="form-control rounded search-filter" 
                    placeholder="Поиск товаров..." 
                    name="search-filter" 
                    value="{{ request.GET.q }}"
                />
                <button class="btn bg-primary text-white rounded">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
        
        <div class="row">
            <!-- Боковая панель фильтров -->
            <div class="col-lg-3 wb-filters-sidebar">
					<div class="border rounded p-3 mb-3">
						<div>
							<h4>Категории</h4>
							<div>
								{% for c in categories %}
									<div class="mb-1 form-check d-flex justify-content-between align-items-center">
										<div>
											<input type="checkbox" class="form-check-input category-filter" value="{{c.id}}" id="category{{c.id}}">
											<label class="form-check-label fs-6" for="category{{c.id}}">{{c.title}}</label>
										</div>
										<div>
											<p class="mb-0">{{c.products.all.count}}</p>
										</div>
									</div>
								{% endfor %}
							</div>
						</div>
					</div>

					

					<div class="border rounded p-3 mb-3">
						<div>
							<h4>Цена</h4>
							<div  style="margin-left: -18px;">
								{% for p in prices %}
									<div class="mb-1 form-check">
										<input type="radio" name="price-filter" value="{{p.id}}" class="form-check-input " id="{{p.id}}">
										<label class="form-check-label fs-6" for="{{p.id}}">{{p.value}}</label>
									</div>
								{% endfor %}
							</div>
						</div>
					</div>

					<div class="border rounded p-3 mb-3">
						<div>
							<h4>Отображение</h4>
							<div  style="margin-left: -18px;">
								{% for i in item_display %}
									<div class="mb-1 form-check">
										<input type="radio" name="items-display" value="{{i.id}}" class="form-check-input items-display" id="display{{i.id}}">
										<label class="form-check-label fs-6" for="display{{i.id}}">{{i.value}} Товаров</label>
									</div>
								{% endfor %}
							</div>
						</div>
					</div>

					<div class="border rounded p-3 mb-3">
						<div>
							<h4>Рейтинг</h4>
							<div>
								
								{% for r in ratings %}
									<div class="mb-1 form-check d-flex justify-content-between align-items-center">
										<div>
											<input type="checkbox" class="form-check-input rating-filter" value="{{r.id}}" id="rating{{r.id}}">
											<label class="form-check-label fs-6" for="rating{{r.id}}">{{r.value}}</label>
										</div>
									</div>
								{% endfor %}
									
								
							</div>
						</div>
					</div>

					<div class="border rounded p-3 mb-3">
						<div>
							<h4>Размеры</h4>
							<div>
								
								{% for s in sizes %}
									<div class="mb-1 form-check d-flex justify-content-between align-items-center">
										<div>
											<input type="checkbox" class="form-check-input size-filter" value="{{s.content}}" id="{{s.content}}">
											<label class="form-check-label fs-6" for="{{s.content}}">{{s.title}}</label>
										</div>
									</div>
								{% endfor %}
							</div>
						</div>
					</div>


					<div class="border rounded p-3 mb-3">
						<div>
							<h4>Цвета</h4>
							<div>
								{% for c in colors %}
									<div class="mb-1 form-check d-flex justify-content-between align-items-center">
										<div class="d-flex align-items-center gap-2">
											<input type="checkbox" class="form-check-input colors-filter" value="{{c.content}}" id="{{c.content}}" >
											<label class="form-check-label fs-6 p-3 colors-filter" for="{{c.content}}" style="background-color: {{c.content}}; color: white; border-radius: 50%;"></label>
										</div>
									</div>
								{% endfor %}
							</div>
						</div>
					</div>

                <button class="btn bg-primary btn-sm rounded reset_shop_filter_btn w-100">Сбросить фильтр <i class="fas fa-rotate ms-2"></i></button>
            </div>
            
            <!-- Основная область с товарами -->
            <div class="col-lg-9">
                <!-- Чипсы выбранных фильтров (будут добавлены через JS) -->
                <div id="wb-filter-chips" class="wb-filter-chips" style="display: none;"></div>
                
                <!-- Сетка товаров (контейнер для AJAX обновлений) -->
                <div class="wb-products-grid" id="products-list">
                    {% include 'partials/_store.html' with products=products %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Подключение JavaScript для улучшенной фильтрации -->
<script src="{% static 'assets/js/shop.js' %}"></script>

{% endblock content %}
